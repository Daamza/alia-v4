<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chat ALIA</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin:0; padding:0;
           display:flex; justify-content:center; align-items:center; height:100vh; }
    #container { width:400px; background:#fff; border-radius:8px;
                 box-shadow:0 2px 10px rgba(0,0,0,0.1); display:flex; flex-direction:column; }
    #msgs { flex:1; padding:16px; overflow-y:auto; }
    .msg { margin-bottom:12px; }
    .msg.user { text-align:right; }
    .msg .txt { display:inline-block; padding:8px 12px; border-radius:16px; max-width:80%; }
    .msg.user .txt { background:#dcf8c6; }
    .msg.bot  .txt { background:#ececec; }
    #entry { display:flex; border-top:1px solid #ddd; }
    #entry input { flex:1; border:none; padding:12px; font-size:14px; }
    #entry button{ border:none; background:#4caf50; color:#fff; padding:0 16px; cursor:pointer; }
  </style>
</head>
<body>
  <div id="container">
    <div id="msgs"></div>
    <div id="entry">
      <input id="inp" placeholder="Escribe tu mensaje..." autocomplete="off"/>
      <button id="btn">Enviar</button>
    </div>
  </div>
  <script>
    const msgs  = document.getElementById('msgs');
    const inp   = document.getElementById('inp');
    const btn   = document.getElementById('btn');

    function addMsg(cls, txt) {
      const d = document.createElement('div');
      d.className = 'msg ' + cls;
      d.innerHTML = `<div class="txt"><strong>${cls==='bot'?'ALIA':'Tú'}:</strong> ${txt}</div>`;
      msgs.appendChild(d);
      d.scrollIntoView({behavior:'smooth'});
    }

    async function send() {
      const text = inp.value.trim();
      if(!text) return;
      addMsg('user', text);
      inp.value='';
      try {
        const r = await fetch('/chat', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({message:text})
        });
        const j = await r.json();
        addMsg('bot', j.reply);
      } catch(e) {
        addMsg('bot', 'Error de conexión');
      }
    }

    btn.addEventListener('click', send);
    inp.addEventListener('keypress', e=>{ if(e.key==='Enter') send(); });
  </script>
</body>
</html>
